{"mappings":"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","sources":["public/js/index.js","public/js/login.js","public/js/alerts.js","public/js/updateSettings.js","public/js/stripe.js"],"sourcesContent":["/* eslint-disable */\r\nimport 'core-js/actual';\r\nimport { login } from './login';\r\nimport { logout } from './login';\r\nimport { updateSettings } from './updateSettings';\r\nimport { bookTour } from './stripe';\r\n\r\n// DOM\r\nconst loginForm = document.querySelector('.form-login');\r\nconst logoutBtn = document.querySelector('.nav__el--logout');\r\nconst updateUserDataForm = document.querySelector('.form-user-data');\r\nconst updateUserPasswordForm = document.querySelector('.form-user-settings');\r\nconst bookBtn = document.querySelector('#book-tour');\r\n\r\nif (loginForm) {\r\n  loginForm.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n\r\n    const email = document.querySelector('#email').value;\r\n    const password = document.querySelector('#password').value;\r\n\r\n    login(email, password);\r\n  });\r\n}\r\n\r\nif (logoutBtn) {\r\n  logoutBtn.addEventListener('click', logout);\r\n}\r\n\r\nif (updateUserDataForm) {\r\n  updateUserDataForm.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n\r\n    const name = document.querySelector('#name').value;\r\n    const email = document.querySelector('#email').value;\r\n\r\n    // Moramo ovako raditi zbog images\r\n    const form = new FormData();\r\n    form.append('name', document.querySelector('#name').value);\r\n    form.append('email', document.querySelector('#email').value);\r\n    form.append('photo', document.querySelector('#photo').files[0]);\r\n\r\n    // console.log('FORM');\r\n    // for (let [key, value] of form.entries()) {\r\n    //   console.log(key, value);\r\n    // }\r\n\r\n    updateSettings(form, 'data');\r\n    // updateSettings({ name, email }, 'data');\r\n  });\r\n}\r\n\r\nif (updateUserPasswordForm) {\r\n  updateUserPasswordForm.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n\r\n    const btn = document.querySelector('.btn--save-password');\r\n    btn.innerHTML = 'Updating...';\r\n\r\n    const passwordCurrent = document.querySelector('#password-current').value;\r\n    const newPassword = document.querySelector('#password').value;\r\n    const passwordConfirm = document.querySelector('#password-confirm').value;\r\n\r\n    updateSettings(\r\n      { passwordCurrent, newPassword, passwordConfirm },\r\n      'password',\r\n    ).then(() => {\r\n      document.querySelector('#password').value = '';\r\n      document.querySelector('#password-confirm').value = '';\r\n      document.querySelector('#password-current').value = '';\r\n\r\n      btn.innerHTML = 'Save password';\r\n    });\r\n  });\r\n}\r\n\r\nif (bookBtn) {\r\n  bookBtn.addEventListener('click', (e) => {\r\n    e.target.textContent = 'Processing...';\r\n    e.preventDefault();\r\n    const tourId = e.target.dataset.tourId;\r\n    bookTour(tourId);\r\n  });\r\n}\r\n","/* eslint-disable */\r\nimport { showAlert } from './alerts';\r\n\r\nconst postData = async (url, data) => {\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n    body: JSON.stringify(data), // body data type must match \"Content-Type\" header\r\n  });\r\n  return response.json();\r\n};\r\n\r\nexport const login = async (email, password) => {\r\n  const res = await postData('http://127.0.0.1:3000/api/v1/users/login', {\r\n    email,\r\n    password,\r\n  });\r\n\r\n  if (res.status === 'success') {\r\n    showAlert('success', 'Successfully logged in');\r\n    window.setTimeout(() => location.assign('/'), 1000);\r\n  } else {\r\n    showAlert('error', res.message);\r\n  }\r\n};\r\n\r\nexport const logout = async () => {\r\n  // console.log('LOGOUT');\r\n  try {\r\n    const res = await fetch('http://127.0.0.1:3000/api/v1/users/logout');\r\n    const data = await res.json();\r\n    // console.log(data);\r\n    if (data.status === 'success') {\r\n      // console.log('Success');\r\n      location.reload(true);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', 'Error logging out :o');\r\n  }\r\n};\r\n","export const showAlert = (type, message) => {\r\n  hideAlert();\r\n  const markup = `<div class=\"alert alert--${type}\">${message}</div>`;\r\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n  window.setTimeout(hideAlert, 5000);\r\n};\r\n\r\nexport const hideAlert = () => {\r\n  const el = document.querySelector('.alert');\r\n  if (el) el.parentElement.removeChild(el);\r\n};\r\n","/* eslint-disable */\r\n\r\nimport { showAlert } from './alerts';\r\n\r\nconst patchData = async (url, data) => {\r\n  const response = await fetch(url, {\r\n    method: 'PATCH',\r\n    // headers: {\r\n    //   'Content-Type': 'application/json',\r\n    // },\r\n    // body: JSON.stringify(data), // body data type must match \"Content-Type\" header\r\n    body: data,\r\n  });\r\n  return response.json();\r\n};\r\n\r\nexport const updateSettings = async (data, type = 'data') => {\r\n  const url =\r\n    type === 'password'\r\n      ? 'http://127.0.0.1:3000/api/v1/users/update-my-password'\r\n      : 'http://127.0.0.1:3000/api/v1/users/update-me';\r\n  const res = await patchData(url, data);\r\n\r\n  if (res.status === 'success') {\r\n    showAlert('success', `Successfully updated ${type}`);\r\n    // window.setTimeout(() => location.assign('/'), 1000);\r\n  } else {\r\n    showAlert('error', res.message);\r\n  }\r\n};\r\n","import { showAlert } from './alerts';\r\n\r\nconst stripe = Stripe(\r\n  'pk_test_51QAavcAQvZCakeQq3AIdR7wMyzPY1xCTT1UFwZ0iqWetBeMGg7PwIANjEldgKGaIL8gxGROKSSXsvFRW20LxPSy400Rtz1WDIw',\r\n);\r\n\r\nconst fetchData = async (url) => {\r\n  const response = await fetch(url, {\r\n    method: 'GET',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n  });\r\n  return response.json();\r\n};\r\n\r\nexport const bookTour = async (tourId) => {\r\n  try {\r\n    // 1) Get checkout session from API\r\n    const session = await fetchData(\r\n      `http://127.0.0.1:3000/api/v1/bookings/checkout-session/${tourId}`,\r\n    );\r\n\r\n    // console.log(session);\r\n\r\n    // 2) Create checkout form + charge credit card\r\n    await stripe.redirectToCheckout({\r\n      sessionId: session.session.id,\r\n    });\r\n  } catch (err) {\r\n    // console.log(err);\r\n    showAlert('error', err);\r\n  }\r\n};\r\n"],"names":[],"version":3,"file":"app.js.map","sourceRoot":"/"}